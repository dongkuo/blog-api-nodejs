# blog-api-nodejs

ğŸ”¥ é‡‡ç”¨Node.jsç¼–å†™çš„åšå®¢åç«¯APIã€‚æ¬¢è¿æäº¤ä»£ç  ğŸš€ :-p

## æ¥å£çº¦å®š

**é™¤éå¸¸éå¸¸ç‰¹åˆ«çš„æƒ…å†µå¤–ï¼Œæ¥å£çš„å®šä¹‰ä¸€å¾‹éµå¾ªä»¥ä¸‹çº¦å®šï¼ï¼ï¼**

### è¯·æ±‚

- è¯·æ±‚è·¯å¾„å‘½åä¸€å¾‹é‡‡ç”¨ ***/{å¯¹è±¡å}/åŠ¨è¯*** çš„æ ¼å¼ã€‚å…¶ä¸­ï¼Œ**å¯¹è±¡å**ç»Ÿä¸€ç”¨å•è¯çš„å•æ•°å½¢å¼ï¼›è€Œ**åŠ¨è¯**åªèƒ½åœ¨ä»¥ä¸‹5ç§ä¸­é€‰æ‹©ï¼š

    | åç§°   | è¯·æ±‚æ–¹å¼ | è¯´æ˜                               |
    | ------ | -------- | ---------------------------------- |
    | add    | POST     | ç”¨äºæ·»åŠ ï¼ˆåˆ›å»ºï¼‰ä¸€ä¸ªå¯¹è±¡           |
    | delete | GET      | ç”¨äºåˆ é™¤ä¸€ä¸ªå¯¹è±¡                   |
    | update | POST     | ç”¨äºæ›´æ–°ä¸€ä¸ªå¯¹è±¡                   |
    | get    | GET      | ç”¨äºè·å–å•ä¸ªå¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯         |
    | list   | GET      | ç”¨äºè·å–å¤šä¸ªå¯¹è±¡çš„åˆ—è¡¨ï¼Œä¸€å¾‹å¸¦åˆ†é¡µ |

- åˆ†é¡µç›¸å…³å‚æ•°æ·»åŠ åœ¨è¯·æ±‚URLä¸Šï¼Œå¦‚ä¸‹ï¼š

    | å‚æ•°å | æ˜¯å¦å¿…é¡» | è¯´æ˜                     |
    | ------ | -------- | ------------------------ |
    | page   | å¦       | é¡µç ã€‚ç¬¬ä¸€é¡µæ˜¯1ï¼Œé»˜è®¤æ˜¯1 |
    | size   | å¦       | é¡µé¢å¤§å°ã€‚é»˜è®¤æ˜¯20       |

- å¯¹äº**POST**è¯·æ±‚ï¼Œ`Content-Type`ä¸€å¾‹ä½¿ç”¨`application/json`ï¼›  

### å“åº”

- æ‰€æœ‰HTTPå“åº”å‡å“åº”200å“åº”ç ï¼›å“åº”`Content-Type` ä½¿ç”¨`application/json`ï¼›å“åº”ä½“æ ¼å¼å¦‚ä¸‹ï¼š

    ```json
    {
        "code": [Number],
        "error": [String],
        "data": [Object]
    }
    ```

- å…¶ä¸­ï¼Œè‹¥è¯·æ±‚æˆåŠŸè¢«å¤„ç†ï¼Œcodeå€¼ä¸€å¾‹å–0ï¼Œå¦åˆ™å–ç›¸åº”é”™è¯¯å€¼ï¼›å½“codeå–0æ—¶ï¼Œerrorä¸€å®šä¸º`null`ï¼›å½“codeä¸ä¸º0æ—¶ï¼Œdataä¸€å®šä¸º`null`

## è§’è‰²æƒé™

### ç”¨æˆ·è§’è‰²

å®šä¹‰å¦‚ä¸‹å‡ ç§**ç”¨æˆ·è§’è‰²**ï¼š

- **ROOT (0)**ï¼šè¶…çº§ç”¨æˆ·ï¼Œè¯¥è§’è‰²ä¸‹ä»…æœ‰ä¸€åç”¨æˆ·ï¼Œå…·æœ‰ä¸€åˆ‡çš„æƒé™ï¼›
- **ADMIN (1)**ï¼šä»£è¡¨ç®¡ç†å‘˜ç”¨æˆ·
- **MEMBER (2)**ï¼šä»£è¡¨ç™»å½•ç”¨æˆ·
- **VISITOR (4)**ï¼šä»£è¡¨æœªç™»å½•ç”¨æˆ·

### ç”¨æˆ·ä»£è¯

å®šä¹‰å¦‚ä¸‹ä¸¤ç§**ç”¨æˆ·ä»£è¯**ï¼š

- **ALL**ï¼šä»£è¡¨ä¸€åˆ‡ç”¨æˆ·ï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½åœ¨æ­¤è§’è‰²ä¸‹
- **OWNER**ï¼šä»£è¡¨èµ„æºåˆ›å»ºè€…æœ¬äººï¼Œè¯¥è§’è‰²ä¸‹ä»…æœ‰â€œè‡ªå·±â€ä¸€ä¸ªç”¨æˆ·ã€‚

## æ¥å£æ¸…å• 

| åç§°         | æƒé™ | è¯·æ±‚æ–¹å¼ | è¯·æ±‚è·¯å¾„        | å®Œæˆæƒ…å†µ |
| ------------ | ------------ | -------- | --------------- | -------- |
| åˆ—å–æ–‡ç« åˆ†ç±» | **ALL** | GET      | /category/list  | ğŸ”¨ |
| æ·»åŠ æ–‡ç« åˆ†ç±» | **ADMIN** | POST     | /category/add   | ğŸ”¨ |
| åˆ é™¤æ–‡ç« åˆ†ç±» | **ADMIN&OWNER** | GET      | /category/delete | ğŸ”¨ |
| ä¿®æ”¹æ–‡ç« åˆ†ç±» | **ADMIN&OWNER** | POST     | /category/update | ğŸ”¨ |
|  |  |  |  |  |
| åˆ—å–æ–‡ç«      | **ALL**  | GET      | /article/list   | â³ |
| è·å–æ–‡ç« è¯¦æƒ… | **ALL**  | GET      | /article/get    | â³ |
| æ·»åŠ æ–‡ç«  | **ADMIN** | POST | /article/add | â³ |
| åˆ é™¤æ–‡ç«  | **ADMIN&OWNER** | GET | /article/delete | â³ |
| ä¿®æ”¹æ–‡ç«  | **ADMIN&OWNER** | POST | /article/update | â³ |
|  |  |  |  |  |
| åˆ—å–æ–‡ç« è¯„è®º | **ALL** | GET | /comment/list | â³ |
| æ·»åŠ æ–‡ç« è¯„è®º | **ADMIN**ã€**MEMBER** | POST | /comment/add | â³ |
| ä¿®æ”¹æ–‡ç« è¯„è®º | **ADMIN**ã€**MEMBER&OWNER** | POST | /comment/update | â³ |
| åˆ é™¤æ–‡ç« è¯„è®º | **ADMIN**ã€**MEMBER&OWNER** | DELETE | /comment/delete | â³ |

## æ¥å£æ˜ç»†

### åˆ—å–æ–‡ç« åˆ†ç±»

**è¯·æ±‚ï¼š**

```http
GET /category/list
```

**å“åº”ï¼š**

```json
[
    {
        "id": 1,
        "name": "å†™ä½œ",
        "url": "/writing"
    },
    {
        "id": 2,
    	"name": "ç¼–ç¨‹",
        "url": "/programing"
    }
]
```

### æ·»åŠ æ–‡ç« åˆ†ç±»

**è¯·æ±‚ï¼š**

```http
POST /category/add

{
    "name": "å†™ä½œ",
    "url": "/writing"
}
```

**å“åº”ï¼š**

```json
{
	"id": 3
}
```

### åˆ é™¤æ–‡ç« åˆ†ç±»

**è¯·æ±‚ï¼š**

```http
GET /category/delete?id=3
```

**å“åº”ï¼š**

```json
<Empty>
```

### ä¿®æ”¹æ–‡ç« åˆ†ç±»

**è¯·æ±‚ï¼š**

```http
POST /category/update

{
	"id": 2,
    "name": "å†™ä½œ",
    "url": "/writing"
}
```

**å“åº”ï¼š**

```json
<Empty>
```



## æ•°æ®åº“è¡¨

### userï¼ˆç”¨æˆ·ï¼‰

| åç§°        | ç±»å‹         | æ˜¯å¦å¿…é¡» | è¯´æ˜                                 |
| ----------- | ------------ | -------- | ------------------------------------ |
| id          | bigint       | æ˜¯       | ä¸»é”®id                               |
| username    | varchar(30)  | æ˜¯       | ç”¨æˆ·å                               |
| password    | varchar(36)  | æ˜¯       | å¯†ç                                  |
| nickname    | varchar(30)  | æ˜¯       | æ˜µç§°                                 |
| email       | varchar(100) | å¦       | é‚®ç®±                                 |
| avatar      | varchar(500) | å¦       | å¤´åƒurl                              |
| status      | tinyint      | æ˜¯       | ç”¨æˆ·çŠ¶æ€ã€‚-1ï¼šåˆ é™¤ï¼›0ï¼šç¦ç”¨ï¼›1ï¼šæ­£å¸¸ |
| create_time | timestamp    | æ˜¯       | åˆ›å»ºæ—¶é—´                             |
| role        | tinyint      | æ˜¯       | è§’è‰²ã€‚å–å€¼è§[è§’è‰²](#è§’è‰²)            |

### categoryï¼ˆæ–‡ç« åˆ†ç±»ï¼‰

| åç§°         | ç±»å‹         | æ˜¯å¦å¿…é¡» | è¯´æ˜                            |
| ------------ | ------------ | -------- | ------------------------------- |
| id           | bigint       | æ˜¯       | ä¸»é”®id                          |
| name         | varchar(20)  | æ˜¯       | åˆ†ç±»åç§°                        |
| url          | varchar(100) | æ˜¯       | åˆ†ç±»å¯¹åº”url                     |
| order_weight | int          | æ˜¯       | æ’åºæƒé‡ã€‚é»˜è®¤å€¼ä¸º0ï¼Œè¶Šå°è¶Šé å‰ |
| create_time  | timestamp    | æ˜¯       | è®°å½•åˆ›å»ºæ—¶é—´                    |

### articleï¼ˆæ–‡ç« ï¼‰

| åç§°             | ç±»å‹         | æ˜¯å¦å¿…é¡» | è¯´æ˜                                |
| ---------------- | ------------ | -------- | ----------------------------------- |
| id               | bigint       | æ˜¯       | ä¸»é”®id                              |
| category_id      | bigint       | æ˜¯       | æ–‡ç« åˆ†ç±»idã€‚å…³è”article_category.id |
| uid              | bigint       | æ˜¯       | ä½œè€…idã€‚å…³è”user.id                 |
| title            | varchar(100) | æ˜¯       | æ–‡ç« æ ‡é¢˜                            |
| cover_image      | varchar(500) | å¦       | å°é¢å›¾ç‰‡URL                         |
| cover_caption    | varchar(20)  | å¦       | å°é¢è¯´æ˜                            |
| summary          | varchar(300) | æ˜¯       | æ–‡ç« æ‘˜è¦                            |
| content_markdown | text         | å¦       | æ–‡ç« å†…å®¹ã€‚markdownæ ¼å¼              |
| content_html     | text         | å¦       | æ–‡ç« å†…å®¹ã€‚htmlæ ¼å¼                  |
| publish_time     | timestamp    | æ˜¯       | å‘è¡¨æ—¶é—´                            |
| create_time      | timestamp    | æ˜¯       | è®°å½•åˆ›å»ºæ—¶é—´                        |
| update_time      | timestamp    | æ˜¯       | è®°å½•æœ€è¿‘ä¿®æ”¹æ—¶é—´                    |
| status           | tinyint      | æ˜¯       | æ–‡ç« çŠ¶æ€ã€‚-1ï¼šåˆ é™¤ï¼›1ï¼šæ­£å¸¸         |

### messageï¼ˆè¯„è®ºã€å›å¤ã€ç•™è¨€â€¦â€¦ï¼‰

| åç§°          | ç±»å‹         | æ˜¯å¦å¿…é¡» | è¯´æ˜                                                         |
| ------------- | ------------ | -------- | ------------------------------------------------------------ |
| id            | bigint       | æ˜¯       | ä¸»é”®id                                                       |
| associated_id | bigint       | æ˜¯       | å…³è”çš„idã€‚è¯¥å€¼ä¸ºè¯„è®ºå…³è”å¯¹è±¡çš„idã€‚å¦‚ï¼šå¯¹äºæŸæ–‡ç« çš„è¯„è®ºï¼Œè¯¥å€¼ä¸ºæ–‡ç« çš„id |
| parent_id     | bigint       | æ˜¯       | çˆ¶è¯„è®ºidã€‚è‹¥è¯¥è¯„è®ºæ˜¯â€œè¯„è®ºçš„å›å¤â€ï¼Œè¯¥å€¼ä¸ºå¯¹åº”è¯„è®ºçš„idï¼›å¦åˆ™ä¸º0ï¼› |
| content       | varchar(300) | æ˜¯       | è¯„è®ºå†…å®¹                                                     |
| uid           | bigint       | æ˜¯       | è¯„è®ºä½œè€…id                                                   |
| create_time   | timestamp    | æ˜¯       | åˆ›å»ºæ—¶é—´                                                     |
| update_time   | timestamp    | æ˜¯       | æœ€è¿‘æ›´æ–°æ—¶é—´                                                 |
| status        | tinyint      | æ˜¯       | è¯„è®ºçŠ¶æ€ã€‚-1ï¼šåˆ é™¤ï¼›1ï¼šæ­£å¸¸                                  |

